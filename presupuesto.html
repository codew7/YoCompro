<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yo Compro</title>

    <style>

        /* Para navegadores como Chrome, Safari y Edge */
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
        }

        /* Estilos globales para la fuente y tamaño de letra */
        body, input, label, button, table, th, td {
            font-family: Arial, sans-serif;
            font-size: 14px; /* Puedes ajustar el tamaño según prefieras */
        }

        label {
            font-family: Arial, sans-serif;
            font-size: 14px; /* Puedes ajustar el tamaño según prefieras */
            font-weight: bold; /* Aplica negrita */
        }

        body { 
            background-color: #f1e31f; 
            color: black; 
            text-align: center; 
        }
        .container { 
            background: white; 
            color: black; 
 
            margin: auto;   
            padding: 15px; 
            border-radius: 10px; 
            position: relative;
        }
        
        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: left; 
            margin-bottom: 20px; 
        }

        .encabezado {
            text-align: left; /* Alinea el encabezado al centro */
            margin-bottom: 20px; /* Espacio debajo del encabezado */
            vertical-align: top;
        }

        .encabezado h1 {
            margin: 0;
        }

        .encabezado p {
            margin: 0;
            font-size: 14px;
        }

        .encabezado img {
            max-width: 90px; /* Ajusta el tamaño del logo */
            margin-right: 10px; /* Espacio a la derecha del logo */
            align-items: center;
        }

        .totals { 
            display: flex; 
            justify-content: flex-end; 
            flex-direction: column; 
            align-items: flex-end; 
            margin-top: 20px; 
        }
        .actions { 
            display: flex; 
            justify-content: right; 
            gap: 15px; 
            margin-top: 20px; 
        }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            table-layout: auto; /* Ajusta automáticamente el ancho de las columnas */
        }
        
        th, td { 
            border: 1px solid black; 
            padding: 10px; 
            text-align: center; 
            width: auto; /* Permite que el ancho se ajuste al contenido */
        }

        table th:nth-child(2), 
        table td:nth-child(2) {
        text-align: left;
        }

        /* Centrar columnas Cant, ValorU y Total */
        table th:nth-child(1), 
        table td:nth-child(1),
        table th:nth-child(3), 
        table td:nth-child(3),
        table th:nth-child(4), 
        table td:nth-child(4) {
        text-align: center;
        }

        th:nth-child(1), td:nth-child(1) { 
            width: 5%; 
        }

        th:nth-child(2), td:nth-child(2) { 
            width: 65%; 
        }

        th:nth-child(3), td:nth-child(3) { 
            width: 15%; 
        }

        th:nth-child(4), td:nth-child(4) { 
            width: 15%; 
        }

        .cantidad, .articulo, .valor, .total, #descuento, #vendedor, #nombre {
            width: 100%; /* Ajusta el tamaño de los campos */
            padding: 1px; /* Espacio interno de los campos */
            margin: 1px 0; /* Espacio externo de los campos */
            box-sizing: border-box; /* Incluye el borde en el tamaño total */
            
        }

        /* Estilos específicos para los campos */
        #descuento { 
            width: 55px; 
        }

        #vendedor { 
            width: 35px; 
        }

        #nombre, #domicilio, #telefono { 
            width: 250px; 
        }

        #formaPago {
            width: 150px;
        }

        .articulo {
            text-align: left;
        }

        .whatsapp-icon {
        width: 22px;
        height: 22px;
        vertical-align: middle; /* Alinea la imagen con el texto */
        margin-right: 10px;
        }

        /* Estilos para impresión - formato recibo/factura adaptable */
        @media print {
            @page {
                size: auto;
                margin: 15mm;
            }

            * {
                box-sizing: border-box;
            }

            body {
                background-color: white;
                margin: 0;
                padding: 0;
                width: 100%;
            }

            .container {
                width: 100%;
                max-width: 100%;
                margin: 0;
                padding: 10px;
                border-radius: 0;
                box-shadow: none;
                overflow: visible;
            }

            .encabezado {
                text-align: center;
                margin-bottom: 10px;
                border-bottom: 1px dashed #000;
                padding-bottom: 10px;
                overflow: visible;
            }

            .encabezado h3 {
                font-size: 16px;
                margin: 5px 0;
                text-align: left;
            }

            .encabezado p {
                font-size: 11px;
                margin: 2px 0;
            }

            .encabezado img {
                max-width: 60px;
            }

            .encabezado > div {
                overflow: visible;
            }

            .header {
                margin-bottom: 10px;
                border-bottom: 1px dashed #000;
                padding-bottom: 8px;
                width: 100%;
                overflow: visible;
            }

            .header label {
                font-size: 12px;
                display: block;
                word-wrap: break-word;
            }

            /* Ocultar inputs y mostrar solo valores en impresión */
            input, select {
                border: none;
                background: transparent;
                padding: 0;
                font-size: 11px;
                font-weight: normal;
                width: auto !important;
                max-width: 100%;
            }

            select {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }

            label {
                font-size: 11px;
            }

            /* Centrar valores en columnas Cant, ValorU y Total */
            td:nth-child(1), td:nth-child(3), td:nth-child(4) {
                text-align: center !important;
            }

            /* Formatear valores con $ y separador de miles en vista de impresión */
            .valor-print::before {
                content: attr(data-print-value);
            }

            .total-print::before {
                content: attr(data-print-value);
            }

            table {
                font-size: 11px;
                margin-top: 5px;
                width: 100%;
                table-layout: fixed;
                border-collapse: collapse;
            }

            th, td {
                padding: 5px 2px;
                font-size: 11px;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            /* Ajustar anchos de columnas para evitar desbordamiento */
            th:nth-child(1), td:nth-child(1) {
                width: 10%;
            }

            th:nth-child(2), td:nth-child(2) {
                width: 50%;
            }

            th:nth-child(3), td:nth-child(3) {
                width: 20%;
            }

            th:nth-child(4), td:nth-child(4) {
                width: 20%;
            }

            th {
                background-color: #f0f0f0;
            }

            .totals {
                margin-top: 10px;
                border-top: 1px dashed #000;
                padding-top: 10px;
                font-size: 12px;
                width: 100%;
                overflow: visible;
            }

            .totals label {
                font-size: 12px;
                margin: 3px 0;
                display: block;
            }

            /* Ocultar botones y elementos no necesarios en impresión */
            .actions,
            button {
                display: none !important;
            }

            .whatsapp-icon {
                display: none;
            }

            /* Ajustar totales para formato recibo */
            #subtotal, #descuento, #totalFinal {
                font-weight: bold;
            }
        }

    </style>
</head>
<body>
    <div class="container" id="presupuesto">
        
        <div class="encabezado">
            <div style="text-align: center;">
                <img src="logo.png" alt="Logo">
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; vertical-align: middle;">
            <div>
                <h3 style="margin: 0;">Presupuesto</h3>
                <p id="fecha" style="margin: 5px 0; text-align: left;"></p>
            </div>
            <p>Tel. 266 4328198  <img src="whatsapp.png" alt="WhatsApp" class="whatsapp-icon"></p>
            </div>
                
        </div>
        

        <div class="header">
            <label>Nombre: <input type="text" id="nombre"></label>
            <br>
            <label>Domicilio: <input type="text" id="domicilio"></label>
            <br>
            <label>Teléfono: <input type="text" id="telefono"></label>
            <br>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Cant</th>
                    <th>Artículo</th>
                    <th>ValorU.</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody id="items">
                <tr>
                    <td><input type="number" class="cantidad" oninput="calcularTotales()"></td>
                    <td><input type="text" class="articulo"></td>
                    <td><input type="number" class="valor" oninput="calcularTotales()"></td>
                    <td class="total">$0</td>
                </tr>
            </tbody>
        </table>
      <br>
        <button onclick="agregarFila()">Agregar Artículo</button>
        <div class="totals">
            <label>Subtotal: $<span id="subtotal">0</span></label>
        <br>
            <label>Descuento: $<input type="number" id="descuento" value="" oninput="calcularTotales()"></label>
        <br>
            <label>Total Final: $<span id="totalFinal">0</span></label>
        <br>
            <label>Forma de Pago: 
                <select id="formaPago">
                    <option value="" selected disabled>Seleccione</option>
                    <option value="Efectivo">Efectivo</option>
                    <option value="MercadoPago">MercadoPago</option>
                </select>
            </label>
        <br>
        </div>
        <div class="actions">
            <button onclick="compartirPresupuesto()">Imprimir</button>
            <button onclick="nuevoPresupuesto()">Nuevo</button>
        </div>
    </div>
    
    <script>
        // Obtener la fecha actual
        const fechaActual = new Date();

        // Formatear la fecha en formato: día mes año
        const opciones = { year: 'numeric', month: 'long', day: 'numeric' };
        const fechaFormateada = fechaActual.toLocaleDateString('es-ES', opciones);

        // Mostrar la fecha en el elemento con id "fecha"
        document.getElementById('fecha').innerText = fechaFormateada;

        function calcularTotales() {
            let subtotal = 0;
            document.querySelectorAll('#items tr').forEach(row => {
                let cantidad = row.querySelector('.cantidad').value || 0;
                let valor = row.querySelector('.valor').value || 0;
                let total = cantidad * valor;
                row.querySelector('.total').innerText = `$${total}`;
                subtotal += total;
            });
            document.getElementById('subtotal').innerText = subtotal.toLocaleString('es-ES');
            let descuento = document.getElementById('descuento').value || 0;
            document.getElementById('totalFinal').innerText = (subtotal - descuento).toLocaleString('es-ES');
        }

        function agregarFila() {
            let fila = `<tr>
                <td><input type="number" class="cantidad" oninput="calcularTotales()"></td>
                <td><input type="text" class="articulo"></td>
                <td><input type="number" class="valor" oninput="calcularTotales()"></td>
                <td class="total">$0</td>
            </tr>`;
            document.getElementById('items').insertAdjacentHTML('beforeend', fila);
        }

        function formatearParaImpresion() {
            // Formatear valores en la tabla con $ y separador de miles (punto)
            document.querySelectorAll('#items tr').forEach(row => {
                const valorInput = row.querySelector('.valor');
                const totalCell = row.querySelector('.total');
                
                if (valorInput && valorInput.value) {
                    const valorNumerico = parseInt(valorInput.value);
                    const valorFormateado = '$' + valorNumerico.toLocaleString('de-DE'); // Usa punto como separador
                    valorInput.setAttribute('data-original', valorInput.value);
                    valorInput.value = valorFormateado;
                }
                
                if (totalCell) {
                    const totalText = totalCell.innerText.replace('$', '').replace(/[^0-9]/g, '');
                    if (totalText) {
                        const totalNumerico = parseInt(totalText);
                        totalCell.innerText = '$' + totalNumerico.toLocaleString('de-DE'); // Usa punto como separador
                    }
                }
            });
        }

        function restaurarDespuesDeImpresion() {
            // Restaurar valores originales después de imprimir
            document.querySelectorAll('#items tr').forEach(row => {
                const valorInput = row.querySelector('.valor');
                if (valorInput && valorInput.hasAttribute('data-original')) {
                    valorInput.value = valorInput.getAttribute('data-original');
                    valorInput.removeAttribute('data-original');
                }
            });
            calcularTotales();
        }

        function compartirPresupuesto() {
            formatearParaImpresion();
            window.print();
            setTimeout(restaurarDespuesDeImpresion, 100);
        }

        function nuevoPresupuesto() {
            document.getElementById('nombre').value = "";
            document.getElementById('domicilio').value = "";
            document.getElementById('telefono').value = "";
            document.getElementById('descuento').value = 0;
            document.getElementById('formaPago').value = "";
            document.getElementById('subtotal').innerText = 0;
            document.getElementById('totalFinal').innerText = 0;
            document.getElementById('items').innerHTML = `<tr>
                <td><input type="number" class="cantidad" oninput="calcularTotales()"></td>
                <td><input type="text" class="articulo"></td>
                <td><input type="number" class="valor" oninput="calcularTotales()"></td>
                <td class="total">$0</td>
            </tr>`;
        }



    </script>
</body>
</html>